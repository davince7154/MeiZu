"use strict";$(function(){function o(){$.ajax({url:"../server/getShoppingcart.php",data:{userphone:s.getValue("user")},dataType:"json",type:"post",success:function(n){var o;window.dataLength=n.length,$("#shoppingcart-box em").eq(1).text(window.dataLength),n.reverse(),0!==n.length?(5<=n.length&&(n.length=5),o=n.map(function(o,e){return' <li class="'.concat(e==n.length-1?"border_none":"",'">\n                                    <dl>\n                                        <dt><img src="').concat(o.goods_color,'" alt=""></dt>\n                                        <dd>\n                                            <p data-goodsId="').concat(o.goods_id,'" class="goods-name" data-color="').concat(o.goods_color_name,'">').concat(o.goods_name,"</p>\n                                            <em>￥").concat(o.goods_price,"</em>\n                                            <button>删除</button>\n                                        </dd>\n                                    </dl>\n                                </li>")}).join(""),$("#shoppingcart-box .hidden-box").html(o),$("#shoppingcart-box .hidden-box li").click(function(){var o={goodsId:$(this).find(".goods-name").attr("data-goodsId"),goodsColorName:$(this).find(".goods-name").attr("data-color"),userphone:(new Cookie).getValue("user")};$.ajax({data:o,url:"../server/deleteShoppingcart.php",dataType:"json",type:"post"}).done(function(o){alert(o.msg),"success"===o.status&&(window.dataLength=window.dataLength-1,$("#shoppingcart-box em").eq(1).text(window.dataLength))})})):$("#shoppingcart-box .hidden-box").html("<h3>您的购物车空空如也</a></h3>")}})}function e(n,a){return new Promise(function(e,o){$.ajax({url:a,data:n,dataType:"json",type:"post",success:function(o){e(o)}})})}var n=e({goods_type:"手机"},"../server/getTypeBannerAndGoods.php"),a=e({goods_type:"声学"},"../server/getTypeBannerAndGoods.php"),r=e({goods_type:"配件"},"../server/getTypeBannerAndGoods.php"),t=e({goods_type:"生活"},"../server/getTypeBannerAndGoods.php");Promise.all([n,a,r,t]).then(function(o){var e=o.map(function(o,e){return 6<o.length&&(o.length=6),"<ul>".concat(o.map(function(o,e){return'<li data-goodsid="'.concat(o.goods_id,'"><img src="').concat(o.goods_color1.split("||")[0],'" alt=""><span>').concat(o.goods_name,"</span><i>￥</i><em>").concat(o.goods_price,"</em></li>")}).join(""),"</ul>")}).join("");$("#header .index-wrap .header-hid").html(e),$("#header .index-wrap .header-show nav li").each(function(o,e){$(e).mouseenter(function(){$("#header .index-wrap .header-hid").css("display","block").children().eq(o).css("display","block").siblings().css("display","none"),$("#header").css({background:"#fff","border-bottom":"solid 1px #e9e9e9"}).animate({height:"265px"},300),(new Cookie).getValue("user")||$("#user-box img").attr("src","./images/blackUser.png"),$("#shoppingcart-box a em").eq(0).prop({nowColor:void 0===$("#shoppingcart-box a em").eq(0).prop("change")||!1===$("#shoppingcart-box a em").eq(0).prop("change")?$("#shoppingcart-box a em").eq(0).css("color"):$("#shoppingcart-box a em").eq(0).prop("nowColor"),change:!0}).css("color","#333"),$(e).parent().find("a").prop({nowColor:void 0===$(e).find("a").prop("change")||!1===$(e).find("a").prop("change")?$(e).find("a").css("color"):$(e).find("a").prop("nowColor"),change:!0}).css("color","#333"),$(e).find("a").css("color","#008cff")})}),$("#header .index-wrap .header-hid").mouseleave(function(){var o=$("#header .index-wrap .header-show nav li");o.find("a").css("color",o.find("a").prop("nowColor")).prop({nowColor:"none",change:!1}),(new Cookie).getValue("user")||$("#user-box img").attr("src","./images/".concat($("#user-box img").attr("data-color"),"User.png")),$("#shoppingcart-box a em").eq(0).css("color",$("#shoppingcart-box a em").eq(0).prop("nowColor")).prop({nowColor:"none",change:!1}),$(this).css("display","none"),$("#header").stop(!0).css({height:"80px",background:"none","border-bottom":"none"})}),$("#header .index-wrap .header-show nav li").mouseenter(function(){var o;3<$(this).index()&&((o=$("#header .index-wrap .header-show nav li")).find("a").css("color",o.find("a").prop("nowColor")).prop({nowColor:"none",change:!1}),(new Cookie).getValue("user")||$("#user-box img").attr("src","./images/".concat($("#user-box img").attr("data-color"),"User.png")),$("#shoppingcart-box a em").eq(0).css("color",$("#shoppingcart-box a em").eq(0).prop("nowColor")).prop({nowColor:"none",change:!1}),$("#header .index-wrap .header-hid").css("display","none"),$("#header").stop(!0).css({height:"80px",background:"none","border-bottom":"none"}))}),$(".header-hid ul li").click(function(){open("goods.html?goodsId=".concat($(this).data("goodsid")))})});var s=new Cookie,i="";s.getValue("user")?(i='<li id="loginBtn"><a href="login.html"> 登录</a></li>\n                    <li id="regBtn"><a href="reg.html"> 注册</a></li>\n                    <li id="reBtn"><a href="">注销</a></li>',$("#user-box img").prop("src","./images/user.png")):i='<li id="loginBtn"><a href="login.html"> 登录</a></li><li id="regBtn"><a href="reg.html"> 注册</a></li>',$("#userList").html(i),$("#reBtn").click(function(){s.removeCookie("user")}),$("#user-box").mouseenter(function(){$(this).children("#userList").css("display","block")}),$("#user-box").mouseleave(function(){$(this).children("#userList").css("display","none")}),o(),$("#shoppingcart-box").mouseenter(function(){$(this).find(".hidden-box").css("display","block"),s.getValue("user")?o():$(this).find(".hidden-box").html('<h3>您还没有登录，请<a href="login.html">登录</a></h3>')}),$("#shoppingcart-box ").mouseleave(function(){$(this).find(".hidden-box").css("display","none")});var d=["手机","声学","配件","生活"];$("#header .index-wrap .header-show nav li").each(function(o,e){o<=d.length-1&&$(e).find("a").attr("href","goodsType.html?type=".concat(encodeURI(d[o])))})});