"use strict";$(function(){var t=(new Cookie).getValue("user");t?$.ajax({data:{userphone:t},url:"../server/getShoppingcart.php",dataType:"json",type:"post",success:function(o){var t=o.map(function(t,e){return'<tr>\n                            <td class="'.concat(e==o.length-1?"border_none":"",'">\n                                <input type="checkbox"  class="one-check">\n                                <dl class="clear-fix">\n                                    <dt><img src="').concat(t.goods_color,'" alt=""></dt>\n                                    <dd>\n                                        <p class="goods-name" data-goodsId="').concat(t.goods_id,'">').concat(t.goods_name,'</p>\n                                        <p class="goods-color">').concat(t.goods_color_name,'</p>\n                                    </dd>\n                                </dl>\n                            </td>\n                            <td class="').concat(e==o.length-1?"border_none":"",'">\n                                <p class="goods-price">￥').concat(parseFloat(t.goods_price).toFixed(2),'</p>\n                            </td>\n                            <td class="').concat(e==o.length-1?"border_none":"",'"><span class="less-q" style="').concat(1==t.goods_count?"cursor: no-drop; color: #e0e0e0":"",'">-</span><input type="text" value="').concat(t.goods_count,'" maxlength="2"\n                                    class="goods-count"><span class="add-q">+</span></td>\n                            <td class="goods-all-price-box ').concat(e==o.length-1?"border_none":"",'">\n                                <p class="goods-all-price">￥').concat(parseFloat(t.goods_price*parseInt(t.goods_count)).toFixed(2),'</p>\n                            </td>\n                            <td class="').concat(e==o.length-1?"border_none":"",'">\n                                <p class="delete-goods">删除</p>\n                            </td>\n                        </tr>')}).join(""),e='<tr>\n                            <td><input type="checkbox" id="allCheck"><span>全选</span></td>\n                            <td>单价(元)</td>\n                            <td>数量</td>\n                            <td>小计(元)</td>\n                            <td>编辑</td>\n                        </tr>\n                        '.concat(t);function n(){var t=0;$(".one-check").each(function(){$(this).prop("checked")&&(t+=+$(this).parent().siblings(".goods-all-price-box").text().split("￥")[1])}),$("#containerNum").text("￥".concat(t.toFixed(2)))}$("table").html(e),$(".add-q").click(function(){var t=+$(this).prev().val()+1;$(this).prev().val(t).prev().css({cursor:"pointer",color:"#000"});var e=+$(this).parent().prev().text().split("￥")[1];$(this).parent().next().children(".goods-all-price").text("￥".concat((t*e).toFixed(2))),$(this).parents("tr").find(".one-check").prop("checked")&&n()}),$(".less-q").click(function(){var t=$(this).next().val()-1;t<=1&&(t=1,$(this).css({cursor:"no-drop",color:"#e0e0e0"})),$(this).next().val(t);var e=+$(this).parent().prev().text().split("￥")[1];$(this).parent().next().children(".goods-all-price").text("￥".concat((t*e).toFixed(2))),$(this).parents("tr").find(".one-check").prop("checked")&&n()}),$("#allCheck").click(function(){$(".one-check").prop("checked",$(this).prop("checked")),n()}),$(".one-check").click(function(){var o=!0;$(".one-check").each(function(t,e){$(e).prop("checked")||(o=!1,$("#allCheck").prop("checked",!1))}),n(),$("#allCheck").prop("checked",o)}),$(".one-check,#allCheck").click(function(){var t=!1;$(".one-check").each(function(){$(this).prop("checked")&&(t=!0,$("#containerBtn").removeClass("cantBuy"))}),t||$("#containerBtn").addClass("cantBuy")}),$(".delete-goods").click(function(){var e=this,t={goodsId:$(this).parents("tr").find(".goods-name").attr("data-goodsId"),goodsColorName:$(this).parents("tr").find(".goods-color").text(),userphone:(new Cookie).getValue("user")};$.ajax({data:t,url:"../server/deleteShoppingcart.php",dataType:"json",type:"post"}).done(function(t){alert(t.msg),$(e).parents("tr").remove(),n()})})}}):$(".shopping-wrap").html('<h3>您还没有登录，请<a href="login.html">登录</a></h3>')});