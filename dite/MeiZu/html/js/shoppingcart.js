"use strict";$(function(){var n,o=(new Cookie).getValue("user");o?(n=function(){function n(){var o=0;$(".one-check").each(function(){$(this).prop("checked")&&(o+=+$(this).parent().siblings(".goods-all-price-box").text().split("￥")[1])}),$("#containerNum").text("￥".concat(o.toFixed(2)))}$(".add-q").click(function(){var o=+$(this).prev().val()+1;$(this).prev().val(o).prev().css({cursor:"pointer",color:"#000"});var e=+$(this).parent().prev().text().split("￥")[1];$(this).parent().next().children(".goods-all-price").text("￥".concat((o*e).toFixed(2))),$(this).parents("tr").find(".one-check").prop("checked")&&n()}),$(".less-q").click(function(){var o=$(this).next().val()-1;o<=1&&(o=1,$(this).css({cursor:"no-drop",color:"#e0e0e0"})),$(this).next().val(o);var e=+$(this).parent().prev().text().split("￥")[1];$(this).parent().next().children(".goods-all-price").text("￥".concat((o*e).toFixed(2))),$(this).parents("tr").find(".one-check").prop("checked")&&n()}),$("#allCheck").click(function(){$(".one-check").prop("checked",$(this).prop("checked")),n()}),$(".one-check").click(function(){var t=!0;$(".one-check").each(function(o,e){$(e).prop("checked")||(t=!1,$("#allCheck").prop("checked",!1))}),n(),$("#allCheck").prop("checked",t)}),$(".one-check,#allCheck").click(function(){var o=!1;$(".one-check").each(function(){$(this).prop("checked")&&(o=!0,$("#containerBtn").removeClass("cantBuy"))}),o||$("#containerBtn").addClass("cantBuy")}),$(".delete-goods").click(function(){var o={goodsId:$(this).parents("tr").find(".goods-name").attr("data-goodsId"),goodsColorName:$(this).parents("tr").find(".goods-color").text(),userphone:(new Cookie).getValue("user")};$.ajax({data:o,url:"../server/deleteShoppingcart.php",dataType:"json",type:"post"}).done(function(o){alert(o.msg),location.reload()})}),$("#containerBtn").click(function(){var t,n,o;"pointer"===$(this).css("cursor")&&(t=[],n=[],$("table tr").eq(0).siblings().each(function(o,e){$(this).find(".one-check").prop("checked")&&(t.push($(this).find(".goods-name").attr("data-goodsId")),n.push($(this).find(".goods-color").text()))}),o={goodsId:t,goodsColorName:n,userphone:(new Cookie).getValue("user")},$.ajax({data:o,url:"../server/deleteAllGoods.php",dataType:"json",type:"post"}).done(function(o){alert(o.msg),window.location.reload()}))})},$.ajax({data:{userphone:o},url:"../server/getShoppingcart.php",dataType:"json",type:"post",success:function(t){var o,e;0!==t.length?(o=t.map(function(o,e){return'<tr>\n                                    <td class="'.concat(e==t.length-1?"border_none":"",'">\n                                        <input type="checkbox"  class="one-check">\n                                        <dl class="clear-fix">\n                                            <dt><img src="').concat(o.goods_color,'" alt=""></dt>\n                                            <dd>\n                                                <p class="goods-name" data-goodsId="').concat(o.goods_id,'">').concat(o.goods_name,'</p>\n                                                <p class="goods-color">').concat(o.goods_color_name,'</p>\n                                            </dd>\n                                        </dl>\n                                    </td>\n                                    <td class="').concat(e==t.length-1?"border_none":"",'">\n                                        <p class="goods-price">￥').concat(parseFloat(o.goods_price).toFixed(2),'</p>\n                                    </td>\n                                    <td class="').concat(e==t.length-1?"border_none":"",'"><span class="less-q" style="').concat(1==o.goods_count?"cursor: no-drop; color: #e0e0e0":"",'">-</span><input type="text" value="').concat(o.goods_count,'" maxlength="2"\n                                            class="goods-count"><span class="add-q">+</span></td>\n                                    <td class="goods-all-price-box ').concat(e==t.length-1?"border_none":"",'">\n                                        <p class="goods-all-price">￥').concat(parseFloat(o.goods_price*parseInt(o.goods_count)).toFixed(2),'</p>\n                                    </td>\n                                    <td class="').concat(e==t.length-1?"border_none":"",'">\n                                        <p class="delete-goods">删除</p>\n                                    </td>\n                                </tr>')}).join(""),e='<tr>\n                                    <td><input type="checkbox" id="allCheck"><span>全选</span></td>\n                                    <td>单价(元)</td>\n                                    <td>数量</td>\n                                    <td>小计(元)</td>\n                                    <td>编辑</td>\n                                </tr>\n                                '.concat(o),$("table").html(e),n()):$(".shopping-wrap").html('<h3>您的购物车空空如也，去<a href="index.html">购买</a></h3>')}})):$(".shopping-wrap").html('<h3>您还没有登录，请<a href="login.html">登录</a></h3>')});